#################### å…¨å±€é…ç½® ####################

# HTTP ä»£ç†ç«¯å£
port: 7890

# SOCKS5 ä»£ç†ç«¯å£
socks-port: 7891

# Linux å’Œ macOS çš„ redir ä»£ç†ç«¯å£
redir-port: 7892

# TProxy ä»£ç†ç«¯å£ (ä»…é€‚ç”¨äº Linux, éœ€è¦å†…æ ¸æ”¯æŒ)
tproxy-port: 7893

# å…è®¸å±€åŸŸç½‘çš„è¿æ¥
allow-lan: true

# è§„åˆ™æ¨¡å¼ï¼šRuleï¼ˆè§„åˆ™ï¼‰ / Globalï¼ˆå…¨å±€ä»£ç†ï¼‰/ Directï¼ˆå…¨å±€ç›´è¿ï¼‰
mode: rule

# æ˜¯å¦å¼€å¯ UDP è½¬å‘
udp: true

# ipv6å¼€å…³
ipv6: true

# è®¾ç½®æ—¥å¿—è¾“å‡ºçº§åˆ« (é»˜è®¤çº§åˆ«ï¼šsilentï¼Œå³ä¸è¾“å‡ºä»»ä½•å†…å®¹ï¼Œä»¥é¿å…å› æ—¥å¿—å†…å®¹è¿‡å¤§è€Œå¯¼è‡´ç¨‹åºå†…å­˜æº¢å‡ºï¼‰ã€‚
# 5 ä¸ªçº§åˆ«ï¼šsilent / info / warning / error / debugã€‚çº§åˆ«è¶Šé«˜æ—¥å¿—è¾“å‡ºé‡è¶Šå¤§ï¼Œè¶Šå€¾å‘äºè°ƒè¯•ï¼Œè‹¥éœ€è¦è¯·è‡ªè¡Œå¼€å¯ã€‚
log-level: debug
# Clash çš„ RESTful API
external-controller: '0.0.0.0:9090'
experimental:
  ignore-resolve-fail: true

bind-address: '*'
# RESTful API çš„å£ä»¤
secret: ''

# æ‚¨å¯ä»¥å°†é™æ€ç½‘é¡µèµ„æºï¼ˆå¦‚ clash-dashboardï¼‰æ”¾ç½®åœ¨ä¸€ä¸ªç›®å½•ä¸­ï¼Œclash å°†ä¼šæœåŠ¡äº `RESTful API/ui`
# å‚æ•°åº”å¡«å†™é…ç½®ç›®å½•çš„ç›¸å¯¹è·¯å¾„æˆ–ç»å¯¹è·¯å¾„ã€‚
external-ui: /clash-dashboard/

# interface-name: eth0

# tun é…ç½®
tun:
  enable: true
  stack: system
  dns-hijack:
    - 8.8.8.8:53
    - tcp://8.8.8.8:53
    - any:53
    - tcp://any:53
  auto-route: true
  auto-redir: true
  auto-detect-interface: true

# geoé…ç½®
geodata-mode: true
geo-auto-update: true
geo-update-interval: 24
geox-url:
  geoip: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geoip.dat"
  geosite: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geosite.dat"
  mmdb: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/country.mmdb"
  asn: "https://github.com/xishang0128/geoip/releases/download/latest/GeoLite2-ASN.mmdb"

#################### DNS ####################
dns:
  enable: true # å…³é—­å°†ä½¿ç”¨ç³»ç»Ÿ DNS
  listen: 0.0.0.0:53
  ipv6: true # å½“ä¸º false æ—¶, AAAA æŸ¥è¯¢çš„å“åº”å°†ä¸ºç©º
  enhanced-mode: fake-ip
  default-nameserver:
    - 223.5.5.5
    - 119.29.29.29
  fake-ip-range: 198.18.0.1/16
  use-hosts: true
  nameserver-policy:
    'geosite:cn,private':
      - "https://223.5.5.5/dns-query"
      - "https://120.53.53.53/dns-query"
  nameserver:
    - https://doh.pub/dns-query # é»˜è®¤å€¼
    - https://dns.alidns.com/dns-query
    - https://1.1.1.1/dns-query
  fallback:
    - 'https://dns.cloudflare.com/dns-query'
    - 'https://dns.twnic.tw/dns-query'
    - 'tls://8.8.4.4:853'
    - 'tls://1.1.1.1'
  #å¦‚éœ€è¿‡ä»£ç†æŸ¥è¯¢ï¼Œåº”é…ç½® proxy-server-nameserver, ä»¥é˜²å‡ºç°é¸¡è›‹é—®é¢˜
  proxy-server-nameserver:
    - https://doh.pub/dns-query
  #åŠ è½½å¤–ç½‘å¡é¡¿å’Œæ…¢çš„ï¼Œå»æ‰fallbackç»„å¯æ”¹å–„
  fallback-filter:
    geoip: true
    geoip-code: CN
    ipcidr:
    - 0.0.0.0/8
    - 10.0.0.0/8
    - 100.64.0.0/10
    - 127.0.0.0/8
    - 169.254.0.0/16
    - 172.16.0.0/12
    - 192.0.0.0/24
    - 192.0.2.0/24
    - 192.88.99.0/24
    - 192.168.0.0/16
    - 198.18.0.0/15
    - 198.51.100.0/24
    - 203.0.113.0/24
    - 224.0.0.0/4
    - 240.0.0.0/4
    - 255.255.255.255/32
    domain:
    - "+.google.com"
    - "+.facebook.com"
    - "+.youtube.com"
    - "+.githubusercontent.com"
    - "+.googlevideo.com"
    - "+.msftconnecttest.com"
    - "+.msftncsi.com"
    - "+.linkedin.com"
  fake-ip-filter:
    - "*.lan"
    - "*.localdomain"
    - "*.example"
    - "*.invalid"
    - "*.localhost"
    - "*.test"
    - "*.local"
    - "*.home.arpa"
    - 'connect.rom.miui.com'
    - time.*.com
    - time.*.gov
    - time.*.edu.cn
    - time.*.apple.com
    - time-ios.apple.com
    - time1.*.com
    - time2.*.com
    - time3.*.com
    - time4.*.com
    - time5.*.com
    - time6.*.com
    - time7.*.com
    - ntp.*.com
    - ntp1.*.com
    - ntp2.*.com
    - ntp3.*.com
    - ntp4.*.com
    - ntp5.*.com
    - ntp6.*.com
    - ntp7.*.com
    - "*.time.edu.cn"
    - "*.ntp.org.cn"
    - "+.pool.ntp.org"
    - time1.cloud.tencent.com
    - music.163.com
    - "*.music.163.com"
    - "*.126.net"
    - musicapi.taihe.com
    - music.taihe.com
    - songsearch.kugou.com
    - trackercdn.kugou.com
    - "*.kuwo.cn"
    - api-jooxtt.sanook.com
    - api.joox.com
    - joox.com
    - y.qq.com
    - "*.y.qq.com"
    - streamoc.music.tc.qq.com
    - mobileoc.music.tc.qq.com
    - isure.stream.qqmusic.qq.com
    - dl.stream.qqmusic.qq.com
    - aqqmusic.tc.qq.com
    - amobile.music.tc.qq.com
    - "*.xiami.com"
    - "*.music.migu.cn"
    - music.migu.cn
    - "+.msftconnecttest.com"
    - "+.msftncsi.com"
    - localhost.ptlogin2.qq.com
    - localhost.sec.qq.com
    - "+.qq.com"
    - "+.tencent.com"
    - "+.srv.nintendo.net"
    - "*.n.n.srv.nintendo.net"
    - "+.stun.playstation.net"
    - xbox.*.*.microsoft.com
    - "*.*.xboxlive.com"
    - xbox.*.microsoft.com
    - xnotify.xboxlive.com
    - "+.battlenet.com.cn"
    - "+.wotgame.cn"
    - "+.wggames.cn"
    - "+.wowsgame.cn"
    - "+.wargaming.net"
    - proxy.golang.org
    - stun.*.*
    - stun.*.*.*
    - "+.stun.*.*"
    - "+.stun.*.*.*"
    - "+.stun.*.*.*.*"
    - "+.stun.*.*.*.*.*"
    - heartbeat.belkin.com
    - "*.linksys.com"
    - "*.linksyssmartwifi.com"
    - "*.router.asus.com"
    - mesu.apple.com
    - swscan.apple.com
    - swquery.apple.com
    - swdownload.apple.com
    - swcdn.apple.com
    - swdist.apple.com
    - lens.l.google.com
    - stun.l.google.com
    - "+.nflxvideo.net"
    - "*.square-enix.com"
    - "*.finalfantasyxiv.com"
    - "*.ffxiv.com"
    - "*.ff14.sdo.com"
    - ff.dorado.sdo.com
    - "*.mcdn.bilivideo.cn"
    - "+.media.dssott.com"
    - shark007.net
    - Mijia Cloud
    - "+.cmbchina.com"
    - "+.cmbimg.com"
    - local.adguard.org
    - "+.sandai.net"
    - "+.n0808.com"
    - services.googleapis.cn

global-client-fingerprint: chrome # å…¨å±€å®¢æˆ·ç«¯æŒ‡çº¹
global-ua: "Mozilla/5.0; AppleWebKit/537.36; Chrome/91.0.4472.114; Safari/537.36; Shadowrocket/1.9.7; meta/1.0.0; Sing/1.1.0" # å…¨å±€ UA ,é»˜è®¤clash.meta

#################### ç¼“å­˜ ####################
profile:
  store-selected: true # å‚¨å­˜ API å¯¹ç­–ç•¥ç»„çš„é€‰æ‹©,ä»¥ä¾›ä¸‹æ¬¡å¯åŠ¨æ—¶ä½¿ç”¨
  store-fake-ip: true # fake-ip ç¼“å­˜,åŸŸåå†æ¬¡å‘ç”Ÿè¿æ¥æ—¶,ä½¿ç”¨åŸæœ‰æ˜ å°„åœ°å€

# ç½‘ç»œå—…æ¢
sniffer:
  enable: true
  sniff:
    TLS:
      ports: [443, 8443]
    HTTP:
      ports: [80, 8080-8880]
      override-destination: true
    QUIC:
      ports: [443, 8443]
  force-domain:
    - "+.netflix.com"
    - "+.nflxvideo.net"
    - "+.amazonaws.com"
    - "+.media.dssott.com"
  skip-domain:
    - "+.apple.com"
    - Mijia Cloud
    - dlg.io.mi.com
    - "+.jd.com"
    - "+.taobao.com"
    - "+.tmall.com"
    - "*.rc.sunlogin.net"

##å‹¿åŠ¨ï¼Œå¼•ç”¨
p: &p
  type: http
  interval: 86400
  proxy: DIRECT
  size-limit: 0
  header:
    User-Agent:
     - "mihomo"
  health-check:
    enable: true
    url: https://www.gstatic.com/generate_204
    interval: 300
    timeout: 5000
  override:
    udp: true
    skip-cert-verify: true
  exclude-filter: "æœ€æ–°ç½‘å€|å‰©ä½™æµé‡|è¿‡æœŸæ—¶é—´"
u: &u
  use:
  - speed-cat

proxy-providers:
  speed-cat:
    <<: *p
    # ä¿®æ”¹urlä¸ºä½ çš„è®¢é˜…åœ°å€
    url: ""
    path: ./proxy_providers/provider1.yaml

proxy-groups:
  - {name: ğŸ¯ æ€»æ¨¡å¼, type: select, proxies: [ğŸš€ èŠ‚ç‚¹é€‰æ‹©,ğŸŒ¸ è‡ªåŠ¨åˆ‡æ¢,ğŸŒ å…¨çƒç›´è¿]}
  - {name: ğŸš€ èŠ‚ç‚¹é€‰æ‹©, type: select, <<: *u}
  - {name: ğŸŒ¸ è‡ªåŠ¨åˆ‡æ¢, <<: *u, tolerance: 10, type: url-test}
  - {name: â“‚ï¸ å¾®è½¯æœåŠ¡, type: select, proxies: [ğŸŒ å…¨çƒç›´è¿, ğŸ¯ æ€»æ¨¡å¼,ğŸŒ¸ è‡ªåŠ¨åˆ‡æ¢]}
  - {name: ğŸ¤– ChatGPT, type: select, use: [speed-cat], filter: "å°æ¹¾|æ—¥æœ¬|æ–°åŠ å¡|ç¾å›½"}
  - {name: ğŸ“¢ è°·æ­ŒFCM, type: select, proxies: [ğŸŒ å…¨çƒç›´è¿,ğŸ¯ æ€»æ¨¡å¼,ğŸŒ¸ è‡ªåŠ¨åˆ‡æ¢]}
  - {name: ğŸ® æ¸¸æˆå¹³å°, type: select, proxies: [ğŸŒ å…¨çƒç›´è¿,ğŸ¯ æ€»æ¨¡å¼,ğŸŒ¸ è‡ªåŠ¨åˆ‡æ¢]}
  - {name: ğŸ¬ æ²¹ç®¡è§†é¢‘, type: select, proxies: [ğŸ¯ æ€»æ¨¡å¼,ğŸŒ¸ è‡ªåŠ¨åˆ‡æ¢,ğŸŒ å…¨çƒç›´è¿]}
  - {name: ğŸ“² ç”µæŠ¥ä¿¡æ¯, type: select, proxies: [ğŸ¯ æ€»æ¨¡å¼,ğŸŒ¸ è‡ªåŠ¨åˆ‡æ¢,ğŸŒ å…¨çƒç›´è¿]}
  - {name: ğŸ“¢ è°·æ­ŒæœåŠ¡, type: select, proxies: [ğŸ¯ æ€»æ¨¡å¼,ğŸŒ¸ è‡ªåŠ¨åˆ‡æ¢,ğŸŒ å…¨çƒç›´è¿]}
  - {name: ğŸ è‹¹æœæœåŠ¡, type: select, proxies: [ğŸŒ å…¨çƒç›´è¿, ğŸ¯ æ€»æ¨¡å¼,ğŸŒ¸ è‡ªåŠ¨åˆ‡æ¢]}
  - {name: ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹, type: url-test, use: [speed-cat], filter: "é¦™æ¸¯"}
  - {name: ğŸ‡¹ğŸ‡¼ å°æ¹¾èŠ‚ç‚¹, type: url-test, use: [speed-cat], filter: "å°æ¹¾"}
  - {name: ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹, type: url-test, use: [speed-cat], filter: "æ—¥æœ¬"}
  - {name: ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡èŠ‚ç‚¹, type: url-test, use: [speed-cat], filter: "æ–°åŠ å¡"}
  - {name: ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹, type: url-test, use: [speed-cat], filter: "ç¾å›½"}
  - {name: å…¶ä»–èŠ‚ç‚¹, type: url-test, use: [speed-cat], exclude-filter: "é¦™æ¸¯|å°æ¹¾|æ—¥æœ¬|æ–°åŠ å¡|ç¾å›½"}
  - {name: ğŸ‹ æ¼ç½‘ä¹‹é±¼, type: select, proxies: [ğŸ¯ æ€»æ¨¡å¼,ğŸŒ å…¨çƒç›´è¿]}
  - {name: ğŸŒ å…¨çƒç›´è¿, type: select, proxies: [DIRECT]}
  - {name: ğŸ›‘ å¹¿å‘Šæ‹¦æˆª, type: select, proxies: [REJECT]}

##å‹¿åŠ¨ï¼Œå¼•ç”¨ï¼Œè§„åˆ™çš„é‡å¤å†…å®¹ï¼Œ<<: *r
r: &r
  type: http
  behavior: classical
  format: yaml
  interval: 86400
rule-providers:
  GoogleFCM:
    <<: *r
    path: ./rule/GoogleFCM.yaml
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/GoogleFCM/GoogleFCM.yaml"
  ChinaCompanyIp:
    <<: *r
    format: text
    path: ./rule/ChinaCompanyIp.yaml
    url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/ChinaCompanyIp.list"
  ProxyGFWlist:
    <<: *r
    format: text
    path: ./rule/ProxyGFWlist.yaml
    url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/ProxyGFWlist.list"
  Openai:
    <<: *r
    path: ./rule/Openai.yaml
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/OpenAI/OpenAI.yaml"
  Copilot:
    <<: *r
    path: ./rule/Copilot.yaml
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Copilot/Copilot.yaml"
  Claude:
    <<: *r
    path: ./rule/Claude.yaml
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Claude/Claude.yaml"
  Gemini:
    <<: *r
    path: ./rule/Gemini.yaml
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Gemini/Gemini.yaml"
  ChinaMedia:
    <<: *r
    path: ./rule/ChinaMedia.yaml
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/ChinaMedia/ChinaMedia.yaml"
  Epic:
    <<: *r
    path: ./rule/Epic.yaml
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Epic/Epic.yaml"
  Steam:
    <<: *r
    path: ./rule/Steam.yaml
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Steam/Steam.yaml"
  SteamCN:
    <<: *r
    path: ./rule/SteamCN.yaml
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/SteamCN/SteamCN.yaml"
  GameDownloadCN:
    <<: *r
    path: ./rule/GameDownloadCN.yaml
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Game/GameDownloadCN/GameDownloadCN.yaml"
  Telegram:
    <<: *r
    path: ./rule/Telegram.yaml
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Telegram/Telegram.yaml"
  Youtube:
    <<: *r
    path: ./rule/Youtube.yaml
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/YouTube/YouTube.yaml"
  Google:
    <<: *r
    path: ./rule/Google.yaml
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Google/Google.yaml"
  Microsoft:
    <<: *r
    path: ./rule/Microsoft.yaml
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Microsoft/Microsoft.yaml"
  Apple:
    <<: *r
    path: ./rule/Apple.yaml
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Apple/Apple.yaml"
  Advertising:
    <<: *r
    path: ./rule/Advertising.yaml
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Clash/Advertising/Advertising_Classical.yaml"

rules:
  # è‡ªå®šä¹‰è§„åˆ™å†™åœ¨è¿™é‡Œ
  - DOMAIN-SUFFIX,z-lib.id,ğŸ¯ æ€»æ¨¡å¼
  - DOMAIN-KEYWORD,z-lib,ğŸ¯ æ€»æ¨¡å¼
  - DOMAIN-SUFFIX,download.epicgames.com,ğŸŒ å…¨çƒç›´è¿
  - RULE-SET,GameDownloadCN,ğŸŒ å…¨çƒç›´è¿
  - AND,(AND,(DST-PORT,443),(NETWORK,UDP)),(NOT,((GEOSITE,cn))),REJECT-DROP # ç¦ç”¨quic(ä¸åŒ…æ‹¬å›½å†…)
  - AND,((PROCESS-NAME,clash),(NOT,((IN-TYPE,inner)))),REJECT
  - IP-CIDR,198.18.0.1/16,REJECT,no-resolve
  - IP-CIDR,198.168.3.1/24,DIRECT
  - GEOSITE,category-ads-all,ğŸ›‘ å¹¿å‘Šæ‹¦æˆª
  - RULE-SET,Advertising,ğŸ›‘ å¹¿å‘Šæ‹¦æˆª
  - GEOSITE,private,ğŸŒ å…¨çƒç›´è¿
  - GEOIP,private,ğŸŒ å…¨çƒç›´è¿,no-resolve
  - RULE-SET,GameDownloadCN,ğŸŒ å…¨çƒç›´è¿
  - RULE-SET,SteamCN,ğŸŒ å…¨çƒç›´è¿
  - RULE-SET,Openai,ğŸ¤– ChatGPT
  - RULE-SET,Claude,ğŸ¤– ChatGPT
  - RULE-SET,Copilot,ğŸ¤– ChatGPT
  - RULE-SET,Gemini,ğŸ¤– ChatGPT
  - RULE-SET,GoogleFCM,ğŸ“¢ è°·æ­ŒFCM
  - RULE-SET,Youtube,ğŸ¬ æ²¹ç®¡è§†é¢‘
  - RULE-SET,Google,ğŸ“¢ è°·æ­ŒæœåŠ¡
  - RULE-SET,Apple,ğŸ è‹¹æœæœåŠ¡
  - RULE-SET,Microsoft,â“‚ï¸ å¾®è½¯æœåŠ¡
  - RULE-SET,Telegram,ğŸ“² ç”µæŠ¥ä¿¡æ¯
  - RULE-SET,Epic,ğŸ® æ¸¸æˆå¹³å°
  - RULE-SET,Steam,ğŸ® æ¸¸æˆå¹³å°
  - RULE-SET,ProxyGFWlist,ğŸ¯ æ€»æ¨¡å¼
  - GEOSITE,gfw,ğŸ¯ æ€»æ¨¡å¼
  - RULE-SET,ChinaCompanyIp,ğŸŒ å…¨çƒç›´è¿
  - RULE-SET,ChinaMedia,ğŸŒ å…¨çƒç›´è¿
  - GEOSITE,CN,ğŸŒ å…¨çƒç›´è¿
  - GEOIP,CN,ğŸŒ å…¨çƒç›´è¿,no-resolve
  - MATCH,ğŸ‹ æ¼ç½‘ä¹‹é±¼
